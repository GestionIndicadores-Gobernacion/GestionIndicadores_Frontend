<div class="records-container">

  <div class="records-header">
    <h2>Gestión de Registros</h2>
    <button class="btn-primary" routerLink="/dashboard/records/create">Crear Registro</button>
  </div>

  <div class="search-box">
    <input type="text" placeholder="Buscar por componente, indicador o municipio..."
      [(ngModel)]="search" (input)="applyFilter()" />
  </div>


  <div *ngIf="!loading" class="table-wrapper">
    <table class="custom-table">

      <thead>
        <tr>
          <th>ID</th>
          <th>Componente</th>
          <th>Indicador</th>
          <th>Municipio</th>
          <th>Fecha</th>
          <th>Tipo población</th>
          <th class="text-center">Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let r of filteredRecords">

          <td>{{ r.id }}</td>
          <td>{{ componentMap[r.component_id ?? 0] || '—' }}</td>
          <td>{{ indicatorMap[r.indicator_id ?? 0] || '—' }}</td>
          <td>{{ r.municipio }}</td>
          <td>{{ r.fecha | date }}</td>

          <td>
            <ng-container *ngIf="r.tipo_poblacion as tp">
              <span *ngIf="tp.length">{{ tp.join(', ') }}</span>
            </ng-container>
          </td>

          <td class="actions-col">

            <button class="btn-outline" [routerLink]="['/dashboard/records', r.id]">
              Ver
            </button>

            <button class="btn-outline-primary" [routerLink]="['/dashboard/records', r.id, 'edit']">
              Editar
            </button>

            <button class="btn-outline-danger" (click)="deleteRecord(r.id)">
              Eliminar
            </button>

          </td>

        </tr>
      </tbody>

    </table>
  </div>

</div>
