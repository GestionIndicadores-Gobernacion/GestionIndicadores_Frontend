<div class="record-view-container">

  <div class="header-row">
    <h2>Detalle del Registro</h2>
    <button class="btn-secondary" (click)="back()">‚Üê Volver</button>
  </div>

  <!-- LOADING -->
  <div *ngIf="loading" class="loading-box">
    <div class="spinner"></div>
  </div>

  <!-- CONTENT -->
  <div *ngIf="!loading && record">

    <!-- ============================
         üìå DATOS GENERALES
    ============================ -->
    <div class="view-card">
      <h3>Datos generales</h3>

      <div class="info-grid">

        <div class="info-item">
          <span>Estrategia</span>
          {{ strategyMap[record.strategy_id] || '‚Äî' }}
        </div>

        <div class="info-item">
          <span>Componente</span>
          {{ componentMap[record.component_id] || '‚Äî' }}
        </div>

        <div class="info-item">
          <span>Actividad</span>
          {{ activityMap[record.activity_id] || '‚Äî' }}
        </div>

        <div class="info-item">
          <span>Fecha del Registro</span>
          {{ record.fecha | date:'mediumDate' }}
        </div>

        <div class="info-item">
          <span>Registrado el</span>
          {{ record.fecha_registro | date:'medium' }}
        </div>

      </div>
    </div>

    <!-- ============================
         üìå DESCRIPCI√ìN
    ============================ -->
    <div class="view-card">
      <h3>Resumen ejecutivo</h3>

      <p class="text-block" *ngIf="record.description; else noDesc">
        {{ record.description }}
      </p>

      <ng-template #noDesc>
        <p class="empty-text">No se registr√≥ un resumen ejecutivo.</p>
      </ng-template>
    </div>

    <!-- ============================
         üìå ACTIVIDADES REALIZADAS
    ============================ -->
    <div class="view-card">
      <h3>Actividades realizadas</h3>

      <p class="text-block" *ngIf="record.actividades_realizadas; else noAct">
        {{ record.actividades_realizadas }}
      </p>

      <ng-template #noAct>
        <p class="empty-text">No se registraron actividades realizadas.</p>
      </ng-template>
    </div>

    <!-- ============================
         üìå MUNICIPIOS + INDICADORES
    ============================ -->
    <div class="view-card">
      <h3>Valores por municipio</h3>

      <div *ngIf="municipios.length === 0" class="empty-text">
        No hay municipios registrados en este registro.
      </div>

      <div *ngFor="let muni of municipios" class="municipio-section">

        <h4 class="muni-title">{{ muni }}</h4>

        <table class="detail-table">
          <thead>
            <tr>
              <th>Indicador</th>
              <th>Valor</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let kv of getIndicadoresForMunicipio(muni)">
              <td>{{ kv.key }}</td>
              <td>{{ kv.value }}</td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>

    <!-- ============================
         üìå EVIDENCIA
    ============================ -->
    <div class="view-card">
      <h3>Evidencia</h3>

      <ng-container *ngIf="record.evidencia_url; else noEvidence">
        <a class="evidence-link"
           [href]="record.evidencia_url"
           target="_blank">
          Abrir evidencia
        </a>
      </ng-container>

      <ng-template #noEvidence>
        <p class="no-evidence">Sin evidencia adjunta</p>
      </ng-template>
    </div>

  </div>
</div>
