<div class="record-form-container">

  <!-- T√≠tulo -->
  <h2 class="page-title">
    {{ isEdit ? "Editar Indicador" : "Crear Indicador" }}
  </h2>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-box">
    <div class="spinner"></div>
  </div>

  <form *ngIf="!loading" (ngSubmit)="save()">

    <!-- ==========================
         üìå DATOS GENERALES
         ========================== -->
    <div class="form-section">
      <h3 class="section-title">Datos del indicador</h3>

      <div class="form-grid">

        <!-- Componente -->
        <div class="form-group">
          <label>Componente</label>
          <select
            [(ngModel)]="form.component_id"
            name="component_id"
            required
          >
            <option [ngValue]="null" disabled>Seleccionar componente...</option>
            <option *ngFor="let c of components" [ngValue]="c.id">
              {{ c.name }}
            </option>
          </select>
        </div>

        <!-- Nombre -->
        <div class="form-group">
          <label>Nombre</label>
          <input
            type="text"
            [(ngModel)]="form.name"
            name="name"
            required
          >
        </div>

        <!-- Tipo de dato -->
        <div class="form-group">
          <label>Tipo de dato</label>
          <select
            [(ngModel)]="form.data_type"
            name="data_type"
            required
          >
            <option value="integer">Entero</option>
            <option value="decimal">Decimal</option>
            <option value="boolean">Booleano</option>
            <option value="text">Texto</option>
            <option value="date">Fecha</option>
            <option value="category">Categor√≠a</option>
          </select>
        </div>

        <!-- Obligatorio -->
        <div class="form-group">
          <label class="form-check-label">
            <input
              type="checkbox"
              [(ngModel)]="form.required"
              name="required"
              class="checkbox-inline"
            >
            Obligatorio
          </label>
        </div>

        <!-- Activo -->
        <div class="form-group">
          <label class="form-check-label">
            <input
              type="checkbox"
              [(ngModel)]="form.active"
              name="active"
              class="checkbox-inline"
            >
            Activo
          </label>
        </div>

      </div>
    </div>

    <!-- ==========================
         üìå LISTA DE VALORES
         ========================== -->
    <div class="form-section">
      <h3 class="section-title">Valores permitidos</h3>

      <div class="form-group">
        <label class="form-check-label">
          <input
            type="checkbox"
            [(ngModel)]="form.use_list"
            name="use_list"
            class="checkbox-inline"
          >
          Usar lista de valores permitidos
        </label>
      </div>

      <div class="form-group full" *ngIf="form.use_list">
        <label>Valores (separados por coma)</label>
        <input
          type="text"
          [(ngModel)]="form.allowed_values_text"
          name="allowed_values_text"
          placeholder="Ej: Aceptado, Rechazado, En tr√°mite"
        >
        <small class="help-text">
          Los valores deben estar separados por coma.
        </small>
      </div>

    </div>

    <!-- ==========================
         üìå DESCRIPCI√ìN
         ========================== -->
    <div class="form-section">
      <h3 class="section-title">Descripci√≥n</h3>

      <div class="form-group full">
        <textarea
          rows="3"
          [(ngModel)]="form.description"
          name="description"
          placeholder="Descripci√≥n del indicador"
        ></textarea>
      </div>
    </div>

    <!-- BOTONES -->
    <div class="form-actions">
      <button class="btn-primary" [disabled]="saving">
        {{ saving ? "Guardando..." : (isEdit ? "Actualizar" : "Crear Indicador") }}
      </button>

      <button
        type="button"
        class="btn-secondary-custom"
        [routerLink]="['/dashboard/indicators']"
      >
        Cancelar
      </button>
    </div>

  </form>

</div>
