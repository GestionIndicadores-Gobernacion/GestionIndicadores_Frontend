<div class="records-container">

  <!-- Header -->
  <div class="records-header">
    <h2>Gestión de Indicadores</h2>

    <button class="btn-primary" (click)="goCreate()">
      Crear Indicador
    </button>
  </div>

  <!-- Search -->
  <div class="search-box">
    <input type="text" placeholder="Buscar por nombre o tipo..." [(ngModel)]="search" (input)="applyFilter()" />
  </div>

  <!-- Loading -->
  <div class="loading-box" *ngIf="loading">
    <div class="spinner"></div>
  </div>

  <!-- Tabla -->
  <div *ngIf="!loading" class="table-wrapper">

    <table class="custom-table">

      <thead>
        <tr>
          <th (click)="sortBy('name')" class="sortable">
            Nombre
            <span *ngIf="sortColumn === 'name'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>

          <th (click)="sortBy('data_type')" class="sortable">
            Tipo de dato
            <span *ngIf="sortColumn === 'data_type'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>

          <th (click)="sortBy('required')" class="sortable">
            Obligatorio
            <span *ngIf="sortColumn === 'required'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>

          <th (click)="sortBy('use_list')" class="sortable">
            Lista
            <span *ngIf="sortColumn === 'use_list'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>

          <th (click)="sortBy('active')" class="sortable">
            Estado
            <span *ngIf="sortColumn === 'active'">
              {{ sortDirection === 'asc' ? '▲' : '▼' }}
            </span>
          </th>

          <th class="text-center">Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let i of paginatedIndicators">

          <td>{{ i.name }}</td>

          <td>{{ i.data_type }}</td>

          <td>{{ i.required ? 'Sí' : 'No' }}</td>

          <td>{{ i.use_list ? 'Sí' : 'No' }}</td>

          <td>
            <span class="state-badge" [class.active]="i.active" [class.inactive]="!i.active">
              {{ i.active ? 'Activo' : 'Inactivo' }}
            </span>
          </td>

          <td class="actions-col">

            <button class="btn-outline-primary" (click)="goEdit(i.id)">
              Editar
            </button>

            <button class="btn-outline-danger" (click)="deleteIndicator(i.id)">
              Eliminar
            </button>

          </td>

        </tr>
      </tbody>

    </table>
    <div class="pagination-container" *ngIf="totalPages > 1">

      <button class="page-btn" [disabled]="currentPage === 1" (click)="currentPage = currentPage - 1">
        ◀
      </button>

      <span class="page-info">
        Página {{ currentPage }} de {{ totalPages }}
      </span>

      <button class="page-btn" [disabled]="currentPage === totalPages" (click)="currentPage = currentPage + 1">
        ▶
      </button>

    </div>



  </div>

</div>