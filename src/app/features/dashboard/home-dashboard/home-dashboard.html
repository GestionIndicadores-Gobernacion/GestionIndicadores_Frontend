<div class="container-fluid">

  <!-- Título -->
  <h2 class="mb-4 fw-semibold text-dark">Panel Principal</h2>

  <!-- KPIs -->
  <div class="row g-3 mb-4">
    <div class="col-12 col-md-6 col-xl-4" *ngFor="let card of kpiCards">
      <div class="card kpi-card shadow-sm border-0" [ngClass]="card.colorClass">
        <div class="card-body">
          <h6 class="card-title m-0 text-white opacity-75">{{ card.label }}</h6>
          <p class="kpi-number text-white m-0">{{ kpis[card.key] }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div class="text-center my-5" *ngIf="loading">
    <div class="spinner-border text-primary"></div>
  </div>

  <!-- Contenido principal -->
  <ng-container *ngIf="!loading">

    <!-- Gráficas principales -->
    <div class="row g-4 mb-4">

      <!-- Registros por Municipio -->
      <div class="col-md-6">
        <div class="card shadow-sm p-3 h-100 border-0">
          <h5 class="card-title mb-3 fw-semibold">Registros por Municipio</h5>
          <apx-chart
            [series]="municipiosChart.series"
            [chart]="municipiosChart.chart"
            [xaxis]="municipiosChart.xaxis"
            [stroke]="municipiosChart.stroke"
            [title]="municipiosChart.title">
          </apx-chart>
        </div>
      </div>

      <!-- Registros por Mes -->
      <div class="col-md-6">
        <div class="card shadow-sm p-3 h-100 border-0">
          <h5 class="card-title mb-3 fw-semibold">Registros por Mes</h5>
          <apx-chart
            [series]="mesesChart.series"
            [chart]="mesesChart.chart"
            [xaxis]="mesesChart.xaxis"
            [stroke]="mesesChart.stroke"
            [title]="mesesChart.title">
          </apx-chart>
        </div>
      </div>
    </div>

    <!-- Gráfica secundaria + Tabla -->
    <div class="row g-4">

      <!-- Tipos de Población -->
      <div class="col-md-6">
        <div class="card shadow-sm p-3 h-100 border-0">
          <h5 class="card-title mb-3 fw-semibold">Tipos de Población</h5>
          <apx-chart
            [series]="tiposChart.series"
            [chart]="tiposChart.chart"
            [labels]="tiposChart.labels"
            [legend]="tiposChart.legend"
            [title]="tiposChart.title">
          </apx-chart>
        </div>
      </div>

      <!-- Últimos Registros -->
      <div class="col-md-6">
        <div class="card shadow-sm p-3 h-100 border-0">
          <h5 class="card-title mb-3 fw-semibold">Últimos Registros</h5>

          <table class="table table-hover table-sm align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th>Municipio</th>
                <th>Fecha</th>
                <th>Indicador</th>
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let r of latestRecords">
                <td>{{ r.municipio }}</td>
                <td>{{ r.fecha }}</td>
                <td>{{ r.indicator_id }}</td>
              </tr>
            </tbody>
          </table>

        </div>
      </div>

    </div>

  </ng-container>

</div>
