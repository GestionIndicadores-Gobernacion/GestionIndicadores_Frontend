<div class="dashboard-home">

  <h2 class="page-title">Panel Principal</h2>

  <!-- KPIs -->
  <div class="kpi-grid">
    <div *ngFor="let card of kpiCards" class="kpi-card" [ngClass]="card.colorClass">
      <h6 class="kpi-label">{{ card.label }}</h6>
      <p class="kpi-number">{{ kpis[card.key] }}</p>
    </div>
  </div>

  <ng-container *ngIf="!loading">

    <!-- Gráficas principales -->
    <div class="grid-2">
      <div class="dashboard-card">
        <h5 class="card-title">Registros por Municipio</h5>
        <apx-chart [series]="municipiosChart.series" [chart]="municipiosChart.chart" [xaxis]="municipiosChart.xaxis"
          [stroke]="municipiosChart.stroke" [title]="municipiosChart.title">
        </apx-chart>
      </div>

      <div class="dashboard-card">
        <h5 class="card-title">Registros por Mes</h5>
        <apx-chart [series]="mesesChart.series" [chart]="mesesChart.chart" [xaxis]="mesesChart.xaxis"
          [stroke]="mesesChart.stroke" [title]="mesesChart.title">
        </apx-chart>
      </div>
    </div>

    <!-- Últimos registros -->
    <div class="grid-2">
      <div class="dashboard-card">
        <h5 class="card-title">Últimos Registros</h5>

        <table class="custom-table">
          <thead>
            <tr>
              <th>Municipio</th>
              <th>Fecha</th>
              <th>Componente</th>
              <th>Indicadores</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let r of latestRecords">

              <td>{{ r.municipio }}</td>
              <td>{{ r.fecha | date }}</td>
              <td>{{ componentMap[r.component_id] }}</td>

              <td>
                <div *ngFor="let id of getIndicatorIds(r)">
                  <strong>{{ indicatorMap[id] }}:</strong>
                  {{ r.detalle_poblacion[id] }}
                </div>
              </td>

            </tr>
          </tbody>

        </table>
      </div>
    </div>

  </ng-container>

</div>