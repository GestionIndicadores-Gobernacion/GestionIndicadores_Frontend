<section class="bg-white border border-zinc-200 rounded-2xl overflow-hidden">

    <!-- HEADER -->
    <div class="px-6 py-4 border-b border-zinc-100">
        <h2 class="text-xs font-semibold uppercase tracking-wider text-zinc-900">
            Indicadores medidos
        </h2>
        <p class="text-xs text-zinc-500 mt-0.5">
            Valores registrados durante la ejecución
        </p>
    </div>

    <!-- HINT -->
    <div class="mx-6 mt-4 mb-2 bg-emerald-50 border border-emerald-200 rounded-lg p-3">
        <div class="flex items-start gap-2">
            <svg class="w-4 h-4 text-emerald-600 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
            <p class="text-xs text-emerald-800">
                <strong class="font-medium">Registra los datos medibles:</strong> Completa cada indicador con los
                valores obtenidos durante la intervención. Si hay metas definidas, aparecerán como referencia. Los
                campos marcados como obligatorios deben completarse.
            </p>
        </div>
    </div>

    <!-- INDICATORS LIST -->
    <div class="divide-y divide-zinc-100">
        <div *ngFor="let ind of indicators" class="group px-6 py-5 transition-colors duration-150 hover:bg-zinc-50">
            <div class="flex flex-col md:flex-row gap-4">
                <div class="md:w-72 flex-shrink-0">
                    <h3 class="text-sm font-medium text-zinc-900 leading-tight mb-1">
                        {{ ind.name }}
                        <span *ngIf="ind.is_required" class="text-red-500">*</span>
                    </h3>
                    <p class="text-xs text-zinc-500" *ngIf="getTarget(ind) as meta; else noMeta">
                        Meta: <span class="font-medium text-zinc-700">{{ meta }}</span>
                    </p>
                    <ng-template #noMeta>
                        <p class="text-xs text-zinc-400">Sin meta</p>
                    </ng-template>
                </div>

                <div class="flex-1">
                    <ng-container *ngIf="ind.field_type === 'number'">
                        <input type="number" [ngModel]="values[getIndicatorId(ind)]"
                            (ngModelChange)="setValue(getIndicatorId(ind), $event)" placeholder="0"
                            class="w-full px-3 py-2 text-sm border border-zinc-200 rounded-lg bg-white text-zinc-900 focus:outline-none focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900 transition-colors duration-150" />
                    </ng-container>

                    <ng-container *ngIf="ind.field_type === 'text'">
                        <textarea rows="2" [ngModel]="values[getIndicatorId(ind)]"
                            (ngModelChange)="setValue(getIndicatorId(ind), $event)" placeholder="Escribe aquí..."
                            class="w-full px-3 py-2 text-sm border border-zinc-200 rounded-lg bg-white text-zinc-900 resize-none focus:outline-none focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900 transition-colors duration-150"></textarea>
                    </ng-container>

                    <ng-container *ngIf="ind.field_type === 'select'">
                        <select [ngModel]="values[getIndicatorId(ind)]"
                            (ngModelChange)="setValue(getIndicatorId(ind), $event)"
                            class="w-full px-3 py-2 text-sm border border-zinc-200 rounded-lg bg-white text-zinc-900 cursor-pointer focus:outline-none focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900 transition-colors duration-150">
                            <option [ngValue]="null">Seleccionar opción</option>
                            <option *ngFor="let op of ind.config?.options" [ngValue]="op">{{ op }}</option>
                        </select>
                    </ng-container>

                    <ng-container *ngIf="ind.field_type === 'sum_group'">
                        <div class="space-y-2">
                            <div class="space-y-2">
                                <div *ngFor="let field of ind.config?.fields"
                                    class="flex items-center gap-3 p-2 bg-zinc-50 rounded-lg border border-zinc-100">
                                    <label class="flex-1 text-xs text-zinc-700 leading-tight">{{ field }}</label>
                                    <input type="number" [ngModel]="values[getIndicatorId(ind)]?.[field]"
                                        (ngModelChange)="setSumValue(getIndicatorId(ind), field, $event)"
                                        placeholder="0"
                                        class="w-24 px-3 py-1.5 text-sm text-right border border-zinc-200 rounded-lg bg-white text-zinc-900 focus:outline-none focus:border-zinc-900 focus:ring-1 focus:ring-zinc-900 transition-colors duration-150" />
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-zinc-900 rounded-lg">
                                <span class="text-xs font-semibold text-white uppercase tracking-wide">Total</span>
                                <span class="text-base font-bold text-white tabular-nums">{{
                                    getSumTotal(getIndicatorId(ind)) }}</span>
                            </div>
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>
    </div>

</section>