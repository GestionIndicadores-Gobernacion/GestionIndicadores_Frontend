<div class="sidebar" [class.open]="isOpen">
  <h3 class="sidebar-title">Menú</h3>

  @if (user) {
  <div class="sidebar-user">
    <div class="sidebar-user-avatar">
      {{ user.name.charAt(0) }}
    </div>

    <div class="sidebar-user-data">
      <p class="user-name">{{ user.name }}</p>
      <p class="user-role">{{ role }}</p>
    </div>
  </div>
  }

  <nav>
    @for (item of menu; track item.label) {

    @if (canShow(item)) {

    <!-- ITEM NORMAL -->
    @if (item.route && !item.children && !item.disabled) {
    <a [routerLink]="item.route" routerLinkActive="active">
      {{ item.label }}
    </a>
    }

    <!-- ITEM DESHABILITADO -->
    @if (item.disabled) {
    <a class="disabled-link">
      {{ item.label }}
      <span class="soon">(pronto)</span>
    </a>
    }

    <!-- ITEM CONTENEDOR (Informes PYBA) -->
    @if (item.children) {
    <div class="submenu-header" [class.section-active]="isRecordsSectionActive()">

      <!-- TÍTULO (NO navega) -->
      <span class="submenu-title">
        {{ item.label }}
      </span>

      <!-- FLECHA -->
      <button class="submenu-arrow" type="button" (click)="toggleSection(item.label)">
        <span [class.open]="isExpanded(item.label)">▸</span>
      </button>

    </div>

    @if (isExpanded(item.label)) {
    <div class="submenu">
      @for (child of item.children; track child.label) {
      @if (canShow(child)) {

      <!-- INFORMES (exact match) -->
      @if (child.route === 'records') {
      <a class="submenu-item" [routerLink]="child.route" routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: true }">
        {{ child.label }}
      </a>
      }

      <!-- RESTO DE CHILDREN -->
      @if (child.route !== 'records') {
      <a class="submenu-item" [routerLink]="child.route" routerLinkActive="active">
        {{ child.label }}
      </a>
      }

      }
      }
    </div>
    }
    }

    }

    }
  </nav>

  <!-- LOGOUT -->
  <div class="sidebar-footer">
    <button class="logout-btn" (click)="logout()">
      Salir
    </button>
  </div>

</div>

<!-- Overlay móvil -->
<div class="overlay" *ngIf="isOpen" (click)="closeSidebar()">
</div>